(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};async function e(t){const e=document.querySelector(".container");switch(e.innerHTML="",t.pathname){case"/":e.innerHTML='\n  <form id="enterCity">\n            <div class="block">\n              <label for="city">Введите город</label>\n                <input type="text" id="city" />\n            </div>\n\n            <div class="block">\n              <button type="submit" id="enterCitySubmit">Отправить</button>\n            </div>\n         </form>\n\n         <div class="result"></div>\n\n         <div id="map"></div>\n  ',await r();break;case"/town":const t=function(){const t=location.search;if(""!==t){const e=/\w+/gi.exec(t);return[e[0],`<div class="townName">${e}</div><div class="result"></div>`]}return'\n    <form id="enterCity">\n      <div class="block">\n        <label for="city">Введите город</label>\n          <input type="text" id="city" />\n      </div>\n\n      <div class="block">\n        <button type="submit" id="enterCitySubmit">Отправить</button>\n      </div>\n    </form>\n    \n    <div class="result"></div>\n  '}();"string"==typeof t?(e.innerHTML=t,await r()):(e.innerHTML=t[1],a(await o(t[0])));break;case"/about":e.innerHTML="about page";break;default:e.innerHTML='\n  <form id="enterCity">\n            <div class="block">\n              <label for="city">Введите город</label>\n                <input type="text" id="city" />\n            </div>\n\n            <div class="block">\n              <button type="submit" id="enterCitySubmit">Отправить</button>\n            </div>\n         </form>\n\n         <div class="result"></div>\n\n         <div id="map"></div>\n  '}}function n(){const t=JSON.parse(localStorage.getItem("town"));null!==t&&(function(t){const e=document.querySelector("aside");e.innerHTML="";const n=document.createElement("ul");t.forEach((t=>{const e=document.createElement("li"),o=document.createElement("a");o.setAttribute("href",`/weather/town?${t[1]}`),o.innerHTML=t[0],e.append(o),n.append(e)})),e.append(n)}(t),e(location),document.querySelectorAll("nav a").forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const n=t.target.href;history.pushState({},"",n),e(location)}))})),document.querySelectorAll("aside a").forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const n=t.target.href;history.pushState({},"",n),e(location)}))})))}async function o(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?${`q=${t}`}&units=metric&appid=fcc07198ebd405c615789afc7486fd29`,n=await fetch(e);return await n.json()}catch(t){console.error("Error:",t)}}async function r(){const t=document.querySelector("#enterCity");null!==t&&t.addEventListener("submit",(async e=>{e.preventDefault();const r=t.querySelector("#city").value,c=await o(r);!function(t,e){const o=localStorage.getItem("town");let r=[];const a=t[0].toUpperCase()+t.slice(1);null===o?r.push([a,e.toLocaleLowerCase()]):(r=JSON.parse(o),void 0===r.find((t=>t[0]===a))&&r.push([a,e.toLocaleLowerCase()])),r.length>10&&r.shift(),localStorage.setItem("town",JSON.stringify(r)),n()}(r,c.name),a(c)}));try{const t=await new Promise(((t,e)=>{navigator.geolocation.getCurrentPosition((e=>{const n={latitude:e.coords.latitude,longitude:e.coords.longitude};t(n)}),(t=>{e(t)}))}));a(await async function(t,e){try{const n=`lat=${t}`,o=`https://api.openweathermap.org/data/2.5/weather?${n}${`&lon=${e}`}&units=metric&appid=fcc07198ebd405c615789afc7486fd29`,r=await fetch(o);return await r.json()}catch(t){console.error("Error:",t)}}(t.latitude,t.longitude))}catch(t){console.error("Ошибка получения геопозиции:",t.message)}}function a(t){const e=document.querySelector(".result"),n=document.getElementById("map");if(null!==e){const n=document.createElement("img"),o="https://openweathermap.org/img/wn/",r=t.weather[0].icon;n.setAttribute("src",`${o}${r}.png`);const a=document.createElement("p");a.classList.add("text"),a.innerHTML=`Погода в \n    ${t.name} сейчас \n    ${Math.round(t.main.temp)} &deg;C`;const c=document.createElement("div");c.classList.add("flex"),c.insertAdjacentElement("beforeend",n),c.insertAdjacentElement("beforeend",a),e.innerHTML="",e.insertAdjacentElement("afterbegin",c)}var o,r;null!==n&&(n.innerHTML="",o=t.coord.lat,r=t.coord.lon,ymaps.ready((function(){new ymaps.Map("map",{center:[o,r],zoom:10})})))}t.d({},{GS:()=>a,qD:()=>o,Ew:()=>r}),document.querySelector(".head-row").querySelectorAll("a").forEach((t=>{const e=t.getAttribute("href");t.setAttribute("href",`/weather${e}`)})),document.querySelector("aside").querySelectorAll("a").forEach((t=>{const e=t.getAttribute("href");t.setAttribute("href",`/weather${e}`)})),n()})();
//# sourceMappingURL=main-75829252eba9d6b7c144.js.map